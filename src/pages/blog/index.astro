---
// src/pages/blog/index.astro
import Layout from '../layouts/Layout.astro';
import { getCollection, type CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';

// Busca os posts da coleção 'blog'
const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="Blog | ELOnARTE" description="Artigos e reflexões sobre arte, tecnologia e consciência.">
	<div class="container">
		<header class="blog-header">
			<h1>Blog</h1>
			<p>Nossas reflexões mais recentes sobre arte, tecnologia e consciência.</p>
		</header>
		
		<main>
			{sortedPosts.length > 0 ? (
				<ul class="post-list">
					{sortedPosts.map((post: CollectionEntry<'blog'>) => (
						<li>
							<a href={`/blog/${post.slug}/`} class="post-card">
								<div class="image-container">
									{post.data.heroImage && (
										<Image
											src={post.data.heroImage}
											alt={`Imagem de capa para o post: ${post.data.title}`}
											width={400}
											height={225}
											class="post-image"
										/>
									)}
								</div>
								<div class="post-text">
									<h2 class="post-title">{post.data.title}</h2>
									<p class="post-date">
										{new Date(post.data.pubDate).toLocaleDateString('pt-BR', { year: 'numeric', month: 'long', day: 'numeric' })}
									</p>
									<p class="post-description">{post.data.description}</p>
								</div>
							</a>
						</li>
					))}
				</ul>
			) : (
				<p class="no-posts">Ainda não há publicações no blog. Volte em breve!</p>
			)}
		</main>
	</div>
</Layout>

<style>
	.container {
		max-width: 900px;
	}
	.blog-header {
		text-align: center;
		margin-bottom: 4rem;
	}
	.blog-header h1 {
		font-size: 3rem;
	}
	.blog-header p {
		font-size: 1.125rem;
		color: var(--color-text-secondary);
	}
	.post-list {
		list-style: none;
		padding: 0;
		display: grid;
		gap: 2rem;
	}
	.post-card {
		display: block;
		background-color: var(--color-bg-light);
		border-radius: 12px;
		overflow: hidden;
		text-decoration: none;
		color: var(--color-text-primary);
		transition: transform 0.3s ease, box-shadow 0.3s ease;
		border: 1px solid transparent;
	}
	.post-card:hover {
		transform: translateY(-8px);
		box-shadow: 0 10px 25px rgba(0,0,0,0.2);
		border-color: var(--accent-lilac);
	}
	.image-container {
		width: 100%;
		aspect-ratio: 16 / 9;
		background-color: var(--color-bg);
	}
	.post-image {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}
	.post-text {
		padding: 1.5rem;
	}
	.post-title {
		font-size: 1.5rem;
		margin-bottom: 0.5rem;
	}
	.post-date {
		color: var(--color-text-secondary);
		font-size: 0.9rem;
		margin-bottom: 1rem;
	}
	.no-posts {
		text-align: center;
		padding: 4rem 1rem;
		background-color: var(--color-bg-light);
		border-radius: 8px;
	}
</style>
